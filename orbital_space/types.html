

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Types of Orbital Spaces &mdash; LibChemist 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> LibChemist
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html">Orbital Space Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sparse_maps/index.html">Sparse Maps Sublibrary</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nwchemex-project.github.io/LibChemist/libchemist_cxx_api/index.html">C++ API</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">LibChemist</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Types of Orbital Spaces</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/orbital_space/types.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="types-of-orbital-spaces">
<h1>Types of Orbital Spaces<a class="headerlink" href="#types-of-orbital-spaces" title="Permalink to this headline">¶</a></h1>
<p>Libchemist supports a lot of different types of orbital spaces. This page walks
through those spaces and compares and contrasts them. TODO: Graphic to summarize
this all.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Many of the “classes” on this page are actually typedefs of more fundamental
classes. This point is an implementation detail. Readers are encouraged to
think of them as true classes as it makes things conceptually easier than
disecting very heavily templated types (C++ concepts where are you?)</p>
</div>
<section id="why-not-a-single-class">
<h2>Why Not a Single Class?<a class="headerlink" href="#why-not-a-single-class" title="Permalink to this headline">¶</a></h2>
<p>At first it may be tempting to try to unify the various orbital space types into
a single type just to simplify things. However, the slight differences among the
classes actually have important algorithmic considerations. For example,
<code class="docutils literal notranslate"><span class="pre">DerivedSpace</span></code> is for orbitals that are linear combinations of another orbital
space. <code class="docutils literal notranslate"><span class="pre">CanonicalSpace</span></code> is a subclass of <code class="docutils literal notranslate"><span class="pre">DerivedSpace</span></code> for orbitals which
not only are linear combinations of other orbitals, but also diagonalize the
Fock matrix. While all <code class="docutils literal notranslate"><span class="pre">CanonicalSpace</span></code> instances are also <code class="docutils literal notranslate"><span class="pre">DerivedSpace</span></code>
instances, not all <code class="docutils literal notranslate"><span class="pre">DerivedSpace</span></code> instances are <code class="docutils literal notranslate"><span class="pre">CanonicalSpace</span></code> instances.
Algorithmically, if you need to use the orbital energies you need to take a
<code class="docutils literal notranslate"><span class="pre">CanonicalSpace</span></code> instance, but if you are only going to make use of the
transformation coefficients taking a <code class="docutils literal notranslate"><span class="pre">DerivedSpace</span></code> instance is fine. By
having different types for these scenarios we get compile-time errors when we
try to use a <code class="docutils literal notranslate"><span class="pre">DerivedSpace</span></code> when we need a <code class="docutils literal notranslate"><span class="pre">CanonicalSpace</span></code>. If we went with
a single orbital space class, the alternative would be to add a member function
<code class="docutils literal notranslate"><span class="pre">has_orbital_energies()</span></code> (or the like) and throw if the result is false. In
general we always prefer compile-time errors to runtime errors because the
latter waste time (you have to run the program to learn you made a mistake).</p>
</section>
<section id="dense-versions">
<h2>Dense Versions<a class="headerlink" href="#dense-versions" title="Permalink to this headline">¶</a></h2>
<p>This section looks at the “dense” orbital spaces. Strictly speaking dense
orbital spaces can have sparsity, but that sparsity is restricted to being
block sparse. Dense orbital spaces use <code class="docutils literal notranslate"><span class="pre">type::tensor</span></code> for all tensorial
quantities. This should be contrasted with the sparse orbital spaces which have
at least one <code class="docutils literal notranslate"><span class="pre">type::tensor_of_tensors</span></code> tensorial quantity. Sparse orbital
spaces are signicantly more involved and are covered in the next section.</p>
<section id="basespace">
<h3>BaseSpace<a class="headerlink" href="#basespace" title="Permalink to this headline">¶</a></h3>
<p>This is the base class common to all orbital spaces. It is basically an abstract
base class which defines some methods common to all orbital spaces.</p>
</section>
<section id="aospace">
<h3>AOSpace<a class="headerlink" href="#aospace" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">AOSpace</span></code> instances tend to be the most fundamental spaces. In addition to
being <code class="docutils literal notranslate"><span class="pre">BaseSpace</span></code> instances they also contain the parameters for the atomic
orbitals.</p>
</section>
<section id="derivedspace">
<h3>DerivedSpace<a class="headerlink" href="#derivedspace" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">DerivedSpace</span></code> instances are linear combinations of orbitals in another space.
The <code class="docutils literal notranslate"><span class="pre">DerivedSpace</span></code> class is actually templated on the type of this other
space; however, in most cases the other space is an <code class="docutils literal notranslate"><span class="pre">AOSpace</span></code> instance
(<em>i.e.</em>, the orbitals in the derived space are linear combinations of AOs). This
design makes it possible to chain multiple spaces together, for example by
having a <code class="docutils literal notranslate"><span class="pre">DerivedSpace</span></code> which is a linear combination of another
<code class="docutils literal notranslate"><span class="pre">DerivedSpace</span></code>, which is itself a linear combination of an <code class="docutils literal notranslate"><span class="pre">AOSpace</span></code>. If
your algorithm’s design depends on the intermediate <code class="docutils literal notranslate"><span class="pre">DerivedSpace</span></code> being
present then you’ll get a compile time error if the user folded the two
transformations together since that results in a different type.</p>
</section>
<section id="canonicalspace">
<h3>CanonicalSpace<a class="headerlink" href="#canonicalspace" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">CanonicalSpace</span></code> instaces are subclasses of <code class="docutils literal notranslate"><span class="pre">DerivedSpace</span></code> instances (we
ignore the possibility that the <code class="docutils literal notranslate"><span class="pre">AOSpace</span></code> can be a canonical space, which is
only possible for hydrogenic atoms). In addition to being linear combinations of
another orbital space, the <code class="docutils literal notranslate"><span class="pre">CanonicalSpace</span></code> also diagonalizes the Fock matrix
and thus we can associate orbital energies with each orbital.</p>
</section>
</section>
<section id="sparse-versions">
<h2>Sparse Versions<a class="headerlink" href="#sparse-versions" title="Permalink to this headline">¶</a></h2>
<p>Sparse orbital spaces have at least one tensorial quantity which is of type
<code class="docutils literal notranslate"><span class="pre">type::tensor_of_tensors</span></code>. They may derive from either <code class="docutils literal notranslate"><span class="pre">BaseSpace</span></code> or
<code class="docutils literal notranslate"><span class="pre">DependentBaseSpace</span></code>. There are a lot more sparse orbital spaces simply
because of the fact that we need different combinations of sparse and dense
tensors depending on which parts of the space have been sparsified. This section
assumes you are familiar with the sparse map concept in the context of
sparsity (TODO: link to concept).</p>
<section id="dependentbasespace">
<h3>DependentBaseSpace<a class="headerlink" href="#dependentbasespace" title="Permalink to this headline">¶</a></h3>
<p>This is the equivalent of <code class="docutils literal notranslate"><span class="pre">BaseSpace</span></code> for any orbital space which also has a
sparse map from its orbitals to the independent space. The decision to have
<code class="docutils literal notranslate"><span class="pre">DependentBaseSpace</span></code> be its own base class and not inherit from <code class="docutils literal notranslate"><span class="pre">BaseSpace</span></code>
comes from the fact that classes that inherit from <code class="docutils literal notranslate"><span class="pre">DependentBaseSpace</span></code>
actually behave like a set of orbital sets (<em>i.e.</em>, it contains many sets of
orbitals) and not a single set. Thus questions like “how many orbitals?” become
fuzzy since you have to also specify which of the orbital sets you are
referring to.</p>
</section>
<section id="sparseaospace">
<h3>SparseAOSpace<a class="headerlink" href="#sparseaospace" title="Permalink to this headline">¶</a></h3>
<p>Same as the <code class="docutils literal notranslate"><span class="pre">AOSpace</span></code> class except that it inherits from
<code class="docutils literal notranslate"><span class="pre">DependentBaseSpace</span></code> instead of <code class="docutils literal notranslate"><span class="pre">BaseSpace</span></code>. The result is that this class
describes domains of AOs associated with an independent space.</p>
</section>
<section id="sparseindependentspace">
<h3>SparseIndependentSpace<a class="headerlink" href="#sparseindependentspace" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">SparseIndependentSpace</span></code> inherits from <code class="docutils literal notranslate"><span class="pre">BaseSpace</span></code> (<em>i.e.</em> it does not
include a sparse map from itself to the independent space since it is the
independent space and such a map would be a trivial mapping) and is an orbital
space which is a linear combination of another space. Compared to the dense
<code class="docutils literal notranslate"><span class="pre">DerivedSpace</span></code>, <code class="docutils literal notranslate"><span class="pre">SparseIndependentSpace</span></code> differs in that it is written as a
linear combination of a <code class="docutils literal notranslate"><span class="pre">SparseAOSpace</span></code> and not an <code class="docutils literal notranslate"><span class="pre">AOSpace</span></code>. The result is
that the transformation coefficients are of type <code class="docutils literal notranslate"><span class="pre">type::tensor_of_tensor</span></code> and
not of type <code class="docutils literal notranslate"><span class="pre">type::tensor</span></code>. The mapping from an independent orbital to its
AO domain is stored in the <code class="docutils literal notranslate"><span class="pre">SparseAOSpace</span></code> member. This space is typically
used to model spaces spanned by localized molecular orbitals (LMOs).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The layout of the coefficients is a little odd in that there is one (or more)
independent indices, but only one dependent index. This is because the index
for the derived orbitals is actually an independent index.</p>
</div>
</section>
<section id="sparsederivedspace">
<h3>SparseDerivedSpace<a class="headerlink" href="#sparsederivedspace" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">SparseDerivedSpace</span></code> is similar to the <code class="docutils literal notranslate"><span class="pre">SparseIndependentSpace</span></code> except
that it inherits from <code class="docutils literal notranslate"><span class="pre">DependentBaseSpace</span></code>. This means that
<code class="docutils literal notranslate"><span class="pre">SparseDerivedSpace</span></code> has a sparse map associated with it which maps from the
independent orbitals to domains of the orbitals described by the
<code class="docutils literal notranslate"><span class="pre">SparseDerivedSpace</span></code>. For example one use of this class is for project-atomic
orbitals (PAOs), which are a set of localized virtual oribtals. For the PAOs
the aforementioned sparse map maps from the independent space (usually LMOs or
tuples thereof) to domains of PAOs. The <code class="docutils literal notranslate"><span class="pre">SparseDerivedSpace</span></code> class assumes
that the transformation coefficients go from a <code class="docutils literal notranslate"><span class="pre">SparseAOSpace</span></code> as will be the
case for most (all?) linear-scaling theories.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Should the need arise to have the from space be dense, a new class will be
needed (strictly speaking it would just be a typedef that uses <code class="docutils literal notranslate"><span class="pre">AOSpace</span></code>
instead of <code class="docutils literal notranslate"><span class="pre">SparseAOSpace</span></code>).</p>
</div>
</section>
<section id="sparseindependentcanonicalspace">
<h3>SparseIndependentCanonicalSpace<a class="headerlink" href="#sparseindependentcanonicalspace" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">SparseIndependentCanonicalSpace</span></code> derives from <code class="docutils literal notranslate"><span class="pre">SparseIndependentSpace</span></code>
and additionally associates “energies” with the independent orbitals. In the
typical usage these are simply the diagonal elements of the Fock matrix (which
itself is not diagonal, hence they are not strictly energies). The energies are
stored in an object of type <code class="docutils literal notranslate"><span class="pre">type::tensor</span></code> because they are not sparse (even
if the transformation of the Fock matrix to the independent basis used
sparsity).</p>
</section>
<section id="sparseindependenttuplecanonicalspace">
<h3>SparseIndependentTupleCanonicalSpace<a class="headerlink" href="#sparseindependenttuplecanonicalspace" title="Permalink to this headline">¶</a></h3>
<p>(yes I’m grasping at straws for names). The
<code class="docutils literal notranslate"><span class="pre">SparseIndependentTupleCanonicalSpace</span></code> is similar to the
<code class="docutils literal notranslate"><span class="pre">SparseIndependentCanonicalSpace</span></code> class, but it also includes a sparse map
for the independent orbitals. This sparse map is not the trivial one present in
the <code class="docutils literal notranslate"><span class="pre">SparseIndependentSpace</span></code> and is used to determine which tuples of
independent orbitals are present. The orbital energies are still stored in a
normal tensor because there is still only one energy per tuple.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The layout of the coefficients is even more odd than it was for the
<code class="docutils literal notranslate"><span class="pre">SparseIndependentSpace</span></code>. We now have an independent tuple mapping to
vectors. The first index of the tuple controls which independent orbital it
is, for example given the tuple “ij” the resulting vector of coefficients is
the transformation for the “i”-th independent orbital using the union of the
basis sets of “i” and “j”. In particular note that in general the vector for
tuple “ij” will not be the same as the vector for tuple “ji”.</p>
</div>
</section>
<section id="sparsecanonicalspace">
<h3>SparseCanonicalSpace<a class="headerlink" href="#sparsecanonicalspace" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">SparseCanonicalSpace</span></code> class derives from <code class="docutils literal notranslate"><span class="pre">SparseDerivedSpace</span></code> and
additionally associates energies with each of the dependent derived orbital
spaces in the <code class="docutils literal notranslate"><span class="pre">SparseDerivedSpace</span></code> base class. In other words, the energies
of the orbitals are dependent on the independent orbital index and are stored in
an object of type <code class="docutils literal notranslate"><span class="pre">type::tensor_of_tensors</span></code>. Like the <code class="docutils literal notranslate"><span class="pre">SparseDerivedSpace</span></code>
base class <code class="docutils literal notranslate"><span class="pre">SparseCanonicalSpace</span></code> instances contain sparse maps from the
independent orbitals to canonical orbitals. At the moment this class is only
here for completion, in practice we usually need the
<code class="docutils literal notranslate"><span class="pre">SparseQuasiCanonicalSpace</span></code>…</p>
</section>
<section id="sparsequasicanonicalspace">
<h3>SparseQuasiCanonicalSpace<a class="headerlink" href="#sparsequasicanonicalspace" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">SparseQuasiCanonicalSpace</span></code> somewhat confusingly derives from the
<code class="docutils literal notranslate"><span class="pre">SparseIndependentSpace</span></code>, but they are not an independent space (the
derivation is an artifact of <code class="docutils literal notranslate"><span class="pre">SparseIndependentSpace</span></code> being a typedef). Like a
<code class="docutils literal notranslate"><span class="pre">SparseIndependentSpace</span></code> (or a <code class="docutils literal notranslate"><span class="pre">SparseIndependentCanonicalSpace</span></code>) the
<code class="docutils literal notranslate"><span class="pre">SparseQuasiCanonicalSpace</span></code> instances do not have a map from the independent
space to the orbitals in the <code class="docutils literal notranslate"><span class="pre">SparseQuasiCanonicalSpace</span></code>. In the case of the
<code class="docutils literal notranslate"><span class="pre">SparseQuasiCanonicalSpace</span></code> class this is because in general a given
independent index <span class="math notranslate nohighlight">\(i\)</span> (<span class="math notranslate nohighlight">\(i\)</span> possibly being a tuple) will map to a
set of orbitals <span class="math notranslate nohighlight">\(S_i\)</span> which is disjoint from the set <span class="math notranslate nohighlight">\(S_j\)</span> (for all
<span class="math notranslate nohighlight">\(i\neq j\)</span>). In turn the sparse map is trivial because each orbital only
appears in the domain of one independent index. Unlike the
<code class="docutils literal notranslate"><span class="pre">SparseIndependentCanonicalSpace</span></code>, instances of the
<code class="docutils literal notranslate"><span class="pre">SparseQuasiCanonicalSpace</span></code> do have sparse energies, <em>i.e.</em> the energies of
each orbital are stored in an object of type <code class="docutils literal notranslate"><span class="pre">type::tensor_of_tensor</span></code>.
<code class="docutils literal notranslate"><span class="pre">SparseQuasiCanonicalSpace</span></code> instances also differ from
<code class="docutils literal notranslate"><span class="pre">SparseIndependentSpace</span></code> instances in that the transformations for the
<code class="docutils literal notranslate"><span class="pre">SparseQuasiCanonicalSpace</span></code> contain two dependent indices whereas those of the
<code class="docutils literal notranslate"><span class="pre">SparseIndependentSpace</span></code> only contain one.</p>
<p>An example of a <code class="docutils literal notranslate"><span class="pre">SparseQuasiCanonicalSpace</span></code> is the set of quasi-canonical PAOs
formed by using PAOs of type <code class="docutils literal notranslate"><span class="pre">SparseDerivedSpace</span></code>.</p>
</section>
</section>
</section>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, NWChemEx Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>