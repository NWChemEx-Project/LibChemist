<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Designing the Fragmented Nuclei Class &mdash; Chemist 0.0.0 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Designing the CapSet Class" href="caps.html" />
    <link rel="prev" title="Designing the Nucleus Component" href="nucleus.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            Chemist
          </a>
              <div class="version">
                0.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../overview.html">Overview of Chemist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../sparse_maps/index.html">Sparse Maps Sublibrary</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Developer Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Design Documentation</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../index.html#overview">Overview</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../architecture.html">Architecture of Chemist</a></li>
<li class="toctree-l4 current"><a class="reference internal" href="index.html">Designing the Chemistry Sublibrary</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#physics">Physics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference external" href="https://nwchemex-project.github.io/.github/">Developing for the NWChemEx Organization</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Chemist Tutorials</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nwchemex-project.github.io/Chemist/chemist_cxx_api/index.html">C++ API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Chemist</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Developer Documentation</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Design Documentation</a></li>
          <li class="breadcrumb-item"><a href="index.html">Designing the Chemistry Sublibrary</a></li>
      <li class="breadcrumb-item active">Designing the Fragmented Nuclei Class</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/developer/design/chemistry/fragmented_nuclei.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="designing-the-fragmented-nuclei-class">
<span id="designing-fragmented-nuclei"></span><h1>Designing the Fragmented Nuclei Class<a class="headerlink" href="#designing-the-fragmented-nuclei-class" title="Permalink to this heading"></a></h1>
<p><a class="reference internal" href="fragmented_molecule.html#designing-fragmented-molecule-class"><span class="std std-ref">Designing the FragmentedMolecule Class</span></a> calls for the <code class="docutils literal notranslate"><span class="pre">FragmentedMolecule</span></code>
class to be implemented in terms of a <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code> class. This page
describes the design of the <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code> class.</p>
<section id="what-is-a-fragmented-nuclei">
<h2>What is a fragmented nuclei?<a class="headerlink" href="#what-is-a-fragmented-nuclei" title="Permalink to this heading"></a></h2>
<p>Here, “nuclei” specifically refers to the <code class="docutils literal notranslate"><span class="pre">Nuclei</span></code> class. The <code class="docutils literal notranslate"><span class="pre">Nuclei</span></code>
class holds a set of <code class="docutils literal notranslate"><span class="pre">Nucleus</span></code> objects. A <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code> object
holds subsets of a <code class="docutils literal notranslate"><span class="pre">Nuclei</span></code> objects.</p>
</section>
<section id="why-do-we-need-fragmented-nuclei">
<h2>Why do we need fragmented nuclei?<a class="headerlink" href="#why-do-we-need-fragmented-nuclei" title="Permalink to this heading"></a></h2>
<p>When we break molecules up into fragments, we usually do this by assigning
atoms to fragments (atoms here implying nucleus plus electrons). In practice,
once the atoms have combined to form molecular systems, we get a <code class="docutils literal notranslate"><span class="pre">Nuclei</span></code>
object and the overall electronic properties (charge and multiplicity) of the
system. In order to disentangle the electrons we can first break the <code class="docutils literal notranslate"><span class="pre">Nuclei</span></code>
into subsets. In the subsequent steps we will then assign electrons to the
nuclei in the subsets based on the atomic number of each nucleus and the charge
of the system.</p>
</section>
<section id="fragmented-nuclei-considerations">
<h2>Fragmented Nuclei Considerations<a class="headerlink" href="#fragmented-nuclei-considerations" title="Permalink to this heading"></a></h2>
<dl class="simple" id="fn-non-disjoint">
<dt>Non-disjoint.</dt><dd><p>While many initial fragment-based techniques relied on disjoint fragments,
more modern techniques relax this requirement. The <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code>
class needs to be able to handle multiple fragments, even if those fragments
are non-disjoint.</p>
</dd>
</dl>
<dl class="simple" id="fn-container">
<dt>Container.</dt><dd><p>As described above, the <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code> class is envisioned as being
filled with subsets of a <code class="docutils literal notranslate"><span class="pre">Nuclei</span></code> object. The container should be set-like
but also support indexing.</p>
</dd>
</dl>
<dl class="simple" id="fn-immutable-superset">
<dt>Immutable superset.</dt><dd><p>For the purposes of the super-/sub-set relation we assume that the
<code class="docutils literal notranslate"><span class="pre">Nuclei</span></code> superset has been fully initialized and will not change.</p>
<ul class="simple">
<li><p>If the <code class="docutils literal notranslate"><span class="pre">Nuclei</span></code> object changes it likely will invalidate the elements of
the <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="simple" id="fn-immutable-subsets">
<dt>Immutable subsets.</dt><dd><p>Each subset is thought of as a literal. So while you can add new subsets to
the <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code>, we can’t modify the subset once it’s added.</p>
<ul class="simple">
<li><p>Subsets are guaranteed to be unique and are sorted. Allowing subset
modifications would get tricky since in the process of adding/removing
elements of the subset one may clobber other subsets and/or cause a need
for resorting.</p></li>
</ul>
</dd>
</dl>
<dl class="simple" id="fn-empty-states">
<dt>Empty states.</dt><dd><p>The default constructed object should represent a truly empty state, such a
state does not even have a supersystem set. There is also an empty state
where the supersystem is set, but the object may not contain any fragments.</p>
</dd>
</dl>
<dl class="simple" id="fn-caps">
<dt>Caps</dt><dd><p>When fragments are formed we may sever covalent bonds. To repair the valency
we can add caps.</p>
<ul class="simple">
<li><p>Determining cap placement requires a <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code> object so we
know which nuclei are in which sets. The caps must thus be in addition to
the <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code> class.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="fragmentednuclei-design">
<h2>FragmentedNuclei Design<a class="headerlink" href="#fragmentednuclei-design" title="Permalink to this heading"></a></h2>
<figure class="align-center" id="id1">
<span id="fig-fragmented-nuclei-design"></span><img alt="../../../_images/fragmented_nuclei.png" src="../../../_images/fragmented_nuclei.png" />
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">The classes involved in implementing the <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code> component.</span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>Capping requires a <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code> object to cap. For this reason, we
put the <code class="docutils literal notranslate"><span class="pre">CapSet</span></code> in a class derived from <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code>,
<code class="docutils literal notranslate"><span class="pre">CappedFragmentedNuclei</span></code>.</p>
</section>
<section id="proposed-apis">
<h2>Proposed APIs<a class="headerlink" href="#proposed-apis" title="Permalink to this heading"></a></h2>
<p>The next code block summarizes how we expect users to fill in a
<code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code> and a <code class="docutils literal notranslate"><span class="pre">CappedFragmentedNuclei</span></code> object.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">Nuclei</span><span class="w"> </span><span class="n">nuclei</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="n">get_nuclei</span><span class="p">();</span><span class="w"> </span><span class="c1">//Usually defined by the end-user</span>
<span class="n">FragmentedNuclei</span><span class="w"> </span><span class="n">frags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fragment_nuclei_object</span><span class="p">(</span><span class="n">nuclei</span><span class="p">);</span>
<span class="n">CapSet</span><span class="w"> </span><span class="n">caps</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="n">cap_fragmented_nuclei</span><span class="p">(</span><span class="n">frags</span><span class="p">);</span>
<span class="n">CappedFragmentedNuclei</span><span class="w"> </span><span class="nf">capped_frags</span><span class="p">(</span><span class="n">frags</span><span class="p">,</span><span class="w"> </span><span class="n">caps</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="fragmentednuclei-summary">
<h2>FragmentedNuclei Summary<a class="headerlink" href="#fragmentednuclei-summary" title="Permalink to this heading"></a></h2>
<dl class="simple">
<dt><a class="reference internal" href="#fn-caps"><span class="std std-ref">Caps</span></a></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">FragmentedNuclei</span></code> class will contain a <code class="docutils literal notranslate"><span class="pre">CapSet</span></code> object which
represents the broken bonds and what they are replaced with. Discussion of
the design of the <code class="docutils literal notranslate"><span class="pre">CapSet</span></code> class can be found
<a class="reference internal" href="caps.html#designing-the-caps-class"><span class="std std-ref">Designing the CapSet Class</span></a>.</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="nucleus.html" class="btn btn-neutral float-left" title="Designing the Nucleus Component" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="caps.html" class="btn btn-neutral float-right" title="Designing the CapSet Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, NWChemEx Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>