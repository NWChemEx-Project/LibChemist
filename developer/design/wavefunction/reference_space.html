<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reference Space Design &mdash; Chemist v1.2.5 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=cd41d21b"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Wavefunction Design" href="wavefunction.html" />
    <link rel="prev" title="Vector Space Design" href="vector_spaces.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                v1.2.5
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installing Chemist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../background/index.html">Chemist Background</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Developer Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Design Documentation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../architecture.html">Architecture of Chemist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chemical_system/index.html">Design of the Chemical System Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ao_basis_set/index.html">Design of the AO Basis Set Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topology/index.html">Design of the Topology Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fragmenting/index.html">Design of the Fragmenting Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operator/index.html">Design of the Operator Component</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Design of the Wavefunction Component</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="architecture.html">Architecture of Wavefunction Component</a></li>
<li class="toctree-l4"><a class="reference internal" href="vector_spaces.html">Vector Space Design</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Reference Space Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="wavefunction.html">Wavefunction Design</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../developing_the_chemical_system_component.html">Developing the Chemical System Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../writing_views.html">Creating a New View</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../the_traits_component.html">Understanding the Traits Component</a></li>
<li class="toctree-l2"><a class="reference external" href="https://nwchemex.github.io/.github/">NWChemEx author documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Chemist Tutorials</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nwchemex.github.io/Chemist/chemist_cxx_api/index.html">C++ API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Chemist</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Developer Documentation</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Design Documentation</a></li>
          <li class="breadcrumb-item"><a href="index.html">Design of the Wavefunction Component</a></li>
      <li class="breadcrumb-item active">Reference Space Design</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/developer/design/wavefunction/reference_space.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="reference-space-design">
<span id="rsd-design"></span><h1>Reference Space Design<a class="headerlink" href="#reference-space-design" title="Link to this heading"></a></h1>
<p>This page describes the design of the reference space component of Chemist.</p>
<section id="what-is-a-reference-space">
<h2>What is a Reference Space?<a class="headerlink" href="#what-is-a-reference-space" title="Link to this heading"></a></h2>
<p>Many-electron wavefunctions are expressed in terms of many-electron basis
functions. We define a reference space as the space of many-electron basis
functions which can be used to form a wavefunction. Arguably the most important
many-electron basis functions are written as determinants.</p>
<p>Our present interest in determinants is purely from a quantum chemistry
perspective, not the general mathematical angle. In the context of
quantum chemistry determinants are basis functions for <span class="math notranslate nohighlight">\(N\)</span>-electron
wavefunctions. The name determinant comes from the fact that if you
create an <span class="math notranslate nohighlight">\(N\)</span> by <span class="math notranslate nohighlight">\(N\)</span> matrix, <span class="math notranslate nohighlight">\(\mathbf{M}\)</span>, such that element <span class="math notranslate nohighlight">\(M_{ij}\)</span> is the <span class="math notranslate nohighlight">\(i\)</span>-th
electron occupying the <span class="math notranslate nohighlight">\(j\)</span>-th orbital, then the determinant of <span class="math notranslate nohighlight">\(\mathbf{M}\)</span> is a
properly antisymmetrized <span class="math notranslate nohighlight">\(N\)</span>-electron basis function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>One obtains the same result by instead defining <span class="math notranslate nohighlight">\(M_{ij}\)</span> as
the <span class="math notranslate nohighlight">\(j\)</span>-th electron in the <span class="math notranslate nohighlight">\(i\)</span>-th orbital, since
<span class="math notranslate nohighlight">\(det\left(\mathbf{M}\right)=det\left(\mathbf{M}^T\right)\)</span>.</p>
</div>
</section>
<section id="why-do-we-need-a-reference-space">
<h2>Why Do We Need a Reference Space?<a class="headerlink" href="#why-do-we-need-a-reference-space" title="Link to this heading"></a></h2>
<p>Vector spaces describe basis sets for one-electron wavefunctions, reference
spaces generalize these concepts to many-electron wavefunctios. In particular,
the reference space component provides us a representation of the space our
wavefunction will live in, but more notably the reference space
will provide us the basis vectors we will build our wavefunction from.</p>
</section>
<section id="reference-space-considerations">
<span id="rsd-considerations"></span><h2>Reference Space Considerations<a class="headerlink" href="#reference-space-considerations" title="Link to this heading"></a></h2>
<dl class="simple" id="rsd-ov">
<dt>Occupied/Virtual</dt><dd><p>As mentioned in the previous section the determinant class is primarily
envisioned as a means of storing how we partitioned the orbitals into
occupied and virtual orbitals. In practice, most methods implicitly create
all determinants they will need by referring to the original partitioning.
Hence we are primarily interested in using the determinant component to
track the reference determinant.</p>
</dd>
</dl>
<dl class="simple" id="rsd-occ-restrict">
<dt>Occupation Restriction</dt><dd><p>Knowing whether each orbital is restricted to doubly occupied, or if there
are some singly occupied orbitals, can lead to algorithm simplifications.
The class hierarchy should make it possible to glean this information from
the type alone.</p>
</dd>
</dl>
<dl class="simple" id="rsd-csf">
<dt>Configuration state functions (CSFs)</dt><dd><p>In general a single determinant is not capable of satisfying the spin
symmetries of an arbitrary system (the notable exception being high-spin
systems). CSFs are eigenfunctions of the spin-projection operator.</p>
</dd>
</dl>
<dl class="simple" id="rsd-product">
<dt>Product spaces.</dt><dd><p>There are methods (<em>e.g.</em>, symmetry-adapted perturbation theory) which use
products of determinants as basis functions for the many-electron
wavefunctions. The catch is that the resulting basis functions are only
antisymmetric within each determinant, not overall (which is what would
happen if one started with tensor product of the orbital spaces and then
took the determinant).</p>
</dd>
</dl>
</section>
<section id="overview-of-reference-space-component">
<h2>Overview of Reference Space Component<a class="headerlink" href="#overview-of-reference-space-component" title="Link to this heading"></a></h2>
<figure class="align-center" id="id1">
<span id="fig-ref-space"></span><img alt="../../../_images/reference_space.png" src="../../../_images/reference_space.png" />
<figcaption>
<p><span class="caption-number">Fig. 18 </span><span class="caption-text">The fundamental classes comprising Chemist’s reference space component.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#fig-ref-space"><span class="std std-numref">Fig. 18</span></a> shows the major pieces of Chemist’s reference space
component. Compared to <a class="reference internal" href="vector_spaces.html#vsd-design"><span class="std std-ref">Vector Space Design</span></a>, the reference space component is
relatively simple; a fact that stems from realizing that most of the variation
in modern electronic structure methods comes from how to choose the orbitals,
or how to approximate the many-electron wavefunction. In other words, there’s
comparatively few ways to create <span class="math notranslate nohighlight">\(N\)</span>-electron basis functions from orbitals.</p>
<section id="reference-space-class">
<h3>Reference Space Class<a class="headerlink" href="#reference-space-class" title="Link to this heading"></a></h3>
<p>The base class of the hierarchy is the <code class="docutils literal notranslate"><span class="pre">ReferenceSpace&lt;V&gt;</span></code> class
(here <code class="docutils literal notranslate"><span class="pre">V</span></code> is the type of a vector space representing the orbital space).
To address the <a class="reference internal" href="#rsd-ov"><span class="std std-ref">Occupied/Virtual</span></a> consideration, this class stores a reference to
the (full) orbital space the basis functions can be created from (<em>i.e.</em>, it
is not just the occupied orbitals) and the orbital occupations.
Admittedly, in many cases, orbital occupations are somewhat trivial to
store implicitly and developers of the <code class="docutils literal notranslate"><span class="pre">ReferenceSpace&lt;V&gt;</span></code> class may opt for
multiple backends depending on whether or not the occupations need to be
explicitly stored (usually only necessary for excited states or fractional
occupations).</p>
</section>
<section id="product-space-class">
<h3>Product Space Class<a class="headerlink" href="#product-space-class" title="Link to this heading"></a></h3>
<p>Consideration <a class="reference internal" href="#rsd-product"><span class="std std-ref">Product spaces.</span></a> leads to needing a class for reference spaces
that are formed from products of other reference spaces. We introduce the
<code class="docutils literal notranslate"><span class="pre">ProductSpace&lt;R...&gt;</span></code> class for this purpose. It is assumed that
<code class="docutils literal notranslate"><span class="pre">ProductSpace&lt;R...&gt;</span></code> will only be used when there are at most a few parameters
in the parameter pack. If one needs a <code class="docutils literal notranslate"><span class="pre">ProductSpace&lt;R..&gt;</span></code> of a large number
of spaces (or an indeterminate number), additional classes should be
added.</p>
</section>
<section id="csf-class">
<h3>CSF Class<a class="headerlink" href="#csf-class" title="Link to this heading"></a></h3>
<p>At this stage the <code class="docutils literal notranslate"><span class="pre">CSF&lt;V&gt;</span></code> class is not very fleshed out. We simply note that
CSFs can be used as alternatives to determinants in many theories. The advantage
of CSFs is that they are eigenfunction of the spin-projection operator
regardless of whether or not we have a high-spin wavefunction. The disadvantage
is they are significantly more complicated than determinants. The addition of
<code class="docutils literal notranslate"><span class="pre">CSF&lt;V&gt;</span></code> directly addresses the <a class="reference internal" href="#rsd-csf"><span class="std std-ref">Configuration state functions (CSFs)</span></a> consideration.</p>
</section>
<section id="determinant-class">
<h3>Determinant Class<a class="headerlink" href="#determinant-class" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Determinant&lt;V&gt;</span></code> class is a strong type guaranteeing that the basis
functions in the reference space are single determinants.</p>
</section>
<section id="high-spin-class">
<h3>High Spin Class<a class="headerlink" href="#high-spin-class" title="Link to this heading"></a></h3>
<p>A number of electronic structure methods assume that the determinant is in a
high-spin state (all unpaired electrons have the same spin). While we could
carry around the spins of each electron, and determine on-the-fly if we have
a high-spin state, we instead have created a strong type <code class="docutils literal notranslate"><span class="pre">HighSpin&lt;V&gt;</span></code> to
denote when a determinant is in a high-spin state. This is justified by the
fact that the user makes this decision (implicitly) based on what method they
select. Combined with the <code class="docutils literal notranslate"><span class="pre">ClosedShell&lt;V&gt;</span></code> class introduced below, the
<code class="docutils literal notranslate"><span class="pre">HighSpin&lt;V&gt;</span></code> class addresses the <a class="reference internal" href="#rsd-occ-restrict"><span class="std std-ref">Occupation Restriction</span></a> consideration.</p>
</section>
<section id="closed-shell-class">
<h3>Closed Shell Class<a class="headerlink" href="#closed-shell-class" title="Link to this heading"></a></h3>
<p>A special (trivial) case of a high-spin determinant is one with no unpaired
electrons. Knowing that there are no unpaired electrons again leads to
simplifications in the resulting theories, which is why we opt to denote this
condition by the <code class="docutils literal notranslate"><span class="pre">ClosedShell&lt;V&gt;</span></code> strong type. Together with the
<code class="docutils literal notranslate"><span class="pre">HighSpin&lt;V&gt;</span></code> class, <code class="docutils literal notranslate"><span class="pre">ClosedShell&lt;V&gt;</span></code> addresses the <a class="reference internal" href="#rsd-occ-restrict"><span class="std std-ref">Occupation Restriction</span></a>
consideration.</p>
</section>
<section id="example-reference-spaces">
<h3>Example Reference Spaces<a class="headerlink" href="#example-reference-spaces" title="Link to this heading"></a></h3>
<p>The remainder of <a class="reference internal" href="#fig-ref-space"><span class="std std-numref">Fig. 18</span></a> shows some template specializations
and strong types for those specializations. We have opted for strong types,
rather than typedefs, primarily to minimize the use of templates in user-facing
classes (which also has the advantage of cleaner compiler errors). Briefly,
the strong types we introduce are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">UDeterminant&lt;T&gt;</span></code>. Class denoting that determinant is expressed in terms
of spin orbitals, occupied in a high-spin state. These are the determinants
considered in methods typically labeled as “unrestricted”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RODeterminant&lt;T&gt;</span></code>. Same as <code class="docutils literal notranslate"><span class="pre">UDeterminant&lt;T&gt;</span></code>, except that the orbitals
are spatial orbitals (not spin). These are the determinants considered in
methods typically labeled as “restricted open-shell”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">RDeterminant&lt;T&gt;</span></code>. Same as <code class="docutils literal notranslate"><span class="pre">RODeterminant&lt;T&gt;</span></code>, except that we additionally
know that there are no singly-occupied orbitals. These are the determinants
considered in methods typically labeled as “restricted”.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">SAPT2BSpace&lt;T&gt;</span></code>. Denotes the reference space is the tensor product of two</dt><dd><p>(closed-shell) monomer wavefunctions.</p>
</dd>
</dl>
</li>
</ul>
<p>Also denoted in <a class="reference internal" href="#fig-ref-space"><span class="std std-numref">Fig. 18</span></a> is that <code class="docutils literal notranslate"><span class="pre">RDeterminant&lt;T&gt;</span></code> should be
implicitly convertible to an object of type <code class="docutils literal notranslate"><span class="pre">RODeterminant&lt;T&gt;</span></code>, which itself
should be implicitly convertible to an object of type <code class="docutils literal notranslate"><span class="pre">UDeterminant&lt;T&gt;</span></code>.
The decision to use implicit conversions is to avoid multiple inheritance, but
still allow physically meaningful conversions (a <code class="docutils literal notranslate"><span class="pre">RDeterminant&lt;T&gt;</span></code> is just
a special case of an <code class="docutils literal notranslate"><span class="pre">RODeterminant&lt;T&gt;</span></code>, which is just a special case of a
<code class="docutils literal notranslate"><span class="pre">UDeterminant&lt;T&gt;</span></code>).</p>
</section>
</section>
<section id="reference-space-design-summary">
<h2>Reference Space Design Summary<a class="headerlink" href="#reference-space-design-summary" title="Link to this heading"></a></h2>
<p>The design of the determinant component satisfies the considerations raised in
section <a class="reference internal" href="#rsd-considerations"><span class="std std-ref">Reference Space Considerations</span></a> by:</p>
<dl class="simple">
<dt><a class="reference internal" href="#rsd-ov"><span class="std std-ref">Occupied/Virtual</span></a></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">Determinant&lt;V&gt;</span></code> class stores a reference to the full orbital space
and the occupation vector.</p>
</dd>
<dt><a class="reference internal" href="#rsd-occ-restrict"><span class="std std-ref">Occupation Restriction</span></a></dt><dd><p>The strong types <code class="docutils literal notranslate"><span class="pre">HighSpin&lt;V&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">ClosedShell&lt;V&gt;</span></code> add occupation
restriction information to the type, facilitating type dispatching based
on how the orbitals are occupied.</p>
</dd>
<dt><a class="reference internal" href="#rsd-csf"><span class="std std-ref">Configuration state functions (CSFs)</span></a></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">CSF&lt;V&gt;</span></code> class was added to the hierarchy to ensure we have a means
of representing many-electron spaces which use CSFs as basis functions.</p>
</dd>
<dt><a class="reference internal" href="#rsd-product"><span class="std std-ref">Product spaces.</span></a></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">ProductSpace</span></code> class allows us to form reference spaces which are
products of other reference spaces.</p>
</dd>
</dl>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="vector_spaces.html" class="btn btn-neutral float-left" title="Vector Space Design" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="wavefunction.html" class="btn btn-neutral float-right" title="Wavefunction Design" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, NWChemEx Community.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>