<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Wavefunction Design &mdash; Chemist v1.2.7 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/tabs.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=5ec1dc68"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Developing the Chemical System Component" href="../../developing_the_chemical_system_component.html" />
    <link rel="prev" title="Reference Space Design" href="reference_space.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html">
            
              <img src="../../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                v1.2.7
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installing Chemist</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../background/index.html">Chemist Background</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Developer Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Design Documentation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../architecture.html">Architecture of Chemist</a></li>
<li class="toctree-l3"><a class="reference internal" href="../chemical_system/index.html">Design of the Chemical System Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ao_basis_set/index.html">Design of the AO Basis Set Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topology/index.html">Design of the Topology Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fragmenting/index.html">Design of the Fragmenting Component</a></li>
<li class="toctree-l3"><a class="reference internal" href="../operator/index.html">Design of the Operator Component</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Design of the Wavefunction Component</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="architecture.html">Architecture of Wavefunction Component</a></li>
<li class="toctree-l4"><a class="reference internal" href="vector_spaces.html">Vector Space Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="reference_space.html">Reference Space Design</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Wavefunction Design</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../developing_the_chemical_system_component.html">Developing the Chemical System Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../writing_views.html">Creating a New View</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../the_traits_component.html">Understanding the Traits Component</a></li>
<li class="toctree-l2"><a class="reference external" href="https://nwchemex.github.io/.github/">NWChemEx author documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Chemist Tutorials</a></li>
<li class="toctree-l1"><a class="reference external" href="https://nwchemex.github.io/Chemist/chemist_cxx_api/index.html">C++ API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">Chemist</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Developer Documentation</a></li>
          <li class="breadcrumb-item"><a href="../index.html">Design Documentation</a></li>
          <li class="breadcrumb-item"><a href="index.html">Design of the Wavefunction Component</a></li>
      <li class="breadcrumb-item active">Wavefunction Design</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/developer/design/wavefunction/wavefunction.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="wavefunction-design">
<h1>Wavefunction Design<a class="headerlink" href="#wavefunction-design" title="Link to this heading"></a></h1>
<p>This section describes the design process of Chemist’s wavefunction component.</p>
<section id="what-is-a-wavefunction">
<h2>What is a Wavefunction?<a class="headerlink" href="#what-is-a-wavefunction" title="Link to this heading"></a></h2>
<p>In quantum mechanics the wavefunction is a mathematical description of the
state of a system. Knowledge of a system’s wavefunction allows one to compute
any knowable property of interest. Thus most of electronic structure theory is
based on either the explicit or implicit computation of wavefunctions.</p>
</section>
<section id="why-do-we-need-a-wavefunction">
<h2>Why Do We Need a Wavefunction?<a class="headerlink" href="#why-do-we-need-a-wavefunction" title="Link to this heading"></a></h2>
<p>At a theoretical level many of the differences in electronic structure methods
come down to how one approximates the system’s wavefunction. Having a fleshed-
out wavefunction component allows us to dispatch among various electronic
structure methods based on C++’s type system. The representation of the
wavefunction is also used to compute properties, and the wavefunction classes
are used to shuttle the representations among functions.</p>
</section>
<section id="wavefunction-considerations">
<span id="wd-considerations"></span><h2>Wavefunction Considerations<a class="headerlink" href="#wavefunction-considerations" title="Link to this heading"></a></h2>
<p>This section lists the considerations which went into the design of Chemist’s
wavefunction component.</p>
<dl class="simple" id="wd-initial">
<dt>Initial Wavefunction</dt><dd><p>In electronic structure theory, most correlated wavefunctions are
mathematically specified by describing the transformation to go from some
many-electron initial wavefunction, <span class="math notranslate nohighlight">\(\left| 0\right\rangle\)</span>, to the correlated
wavefunction. This necessitates classes to describe the initial wavefunction.
Initial wavefunctions are usually expressed in terms of determinants, or
references, giving rise to the sub-considerations:</p>
<ul class="simple">
<li><p>Is the initial wavefunction formed from a single determinant or not?</p></li>
<li><p>If there are multiple determinants, how are the determinants determined?</p></li>
</ul>
</dd>
</dl>
<dl class="simple" id="wd-correlation">
<dt>Correlated Wavefunction</dt><dd><p>As brought up by <a class="reference internal" href="#wd-initial"><span class="std std-ref">Initial Wavefunction</span></a>, most correlated wavefunctions are
mathematically specified by transforming an initial wavefunction. Thus,
in addition to <a class="reference internal" href="#wd-initial"><span class="std std-ref">Initial Wavefunction</span></a>, we need a way to express the
transformations.</p>
<ul class="simple">
<li><p>The distinction between the initial wavefunction and the correlated
wavefunction often defines the (dynamic) correlation energy.</p></li>
</ul>
</dd>
</dl>
<dl class="simple" id="wd-easily-extended">
<dt>Easily Extended.</dt><dd><p>Having to define a wavefunction for every possible electronic structure
theory method is cumbersome. The design should facilitate defining new
wavefunctions, ideally without having to create new classes.</p>
</dd>
</dl>
<dl class="simple" id="wd-type-dispatch">
<dt>Type Dispatch.</dt><dd><p>Wavefunctions are going to be used in property types. The class hierarchy
must support defining property types for entire classes of wavefunctions
as well as for specific wavefunctions. For example, think dispatching
between a correlated method driver and the CCSD correlation energy.</p>
</dd>
</dl>
<section id="not-in-scope">
<h3>Not in Scope<a class="headerlink" href="#not-in-scope" title="Link to this heading"></a></h3>
<p>Many object-oriented quantum chemistry codes have classes named wavefunction,
and thus users coming from those codes may have pre-concieved notions of what
should be in the wavefunction. Here we have collected additional considerations
which were considered in designing the wavefunction, but were then ultimately
decided to be out of scope for the wavefunction component of Chemist.</p>
<dl class="simple">
<dt>Amplitudes.</dt><dd><p>In our design the wavefunctions serve as inputs to methods, specifying what
techniques to use to compute the amplitudes. It is our opinion that, it is
better to obtain the amplitudes by calling a module (usually one that
projects the wavefunction onto the reference), than to try to store them in
the wavefunction.</p>
</dd>
</dl>
</section>
</section>
<section id="overview-of-the-wavefunction-component">
<h2>Overview of the Wavefunction Component<a class="headerlink" href="#overview-of-the-wavefunction-component" title="Link to this heading"></a></h2>
<p>This section summarizes the design of Chemist’s Wavefunction component, in
particular noting how the design addresses the considerations brought up by
<a class="reference internal" href="#wd-considerations"><span class="std std-ref">Wavefunction Considerations</span></a>.</p>
<figure class="align-center" id="id1">
<span id="fig-wavefunction"></span><img alt="../../../_images/wavefunction.png" src="../../../_images/wavefunction.png" />
<figcaption>
<p><span class="caption-number">Fig. 19 </span><span class="caption-text">The classes forming the core of Chemist’s wavefunction component.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The fundamental classes of Chemist’s wavefunction component are shown in
<a class="reference internal" href="#fig-wavefunction"><span class="std std-numref">Fig. 19</span></a>.</p>
<section id="wavefunction-base-class">
<h3>Wavefunction Base Class<a class="headerlink" href="#wavefunction-base-class" title="Link to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Wavefunction&lt;D&gt;</span></code> class is envisioned as a common base class for all
wavefunctions; it’s primarily seen as a container for the wavefunction’s
components. Derived class types signifying restrictions on which components
are present in the wavefunction. Design notes:</p>
<ul class="simple">
<li><p>Conceptually will need to be a recursive structure, since components are
often perfectly good wavefunctions on their own, <em>e.g.</em>, most correlated
wavefunctions have the Hartree-Fock wavefunction as a component</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">D</span></code> will usually be a determinant; however, it could also be a product
of determinants (<em>n.b.</em>, the product of two determinants is not the same
as taking the determinant of the orbital product).</p></li>
</ul>
</section>
<section id="initial-wavefunctions">
<h3>Initial Wavefunctions<a class="headerlink" href="#initial-wavefunctions" title="Link to this heading"></a></h3>
<p>The wavefunction class hierarchy has two branches: the initial wavefunction and
the correlated wavefunction branches.</p>
<section id="multi-reference-wavefunction-class">
<h4>Multi-Reference Wavefunction Class<a class="headerlink" href="#multi-reference-wavefunction-class" title="Link to this heading"></a></h4>
<p>All wavefunctions which are used as initial wavefunctions contain one or more
references. The <code class="docutils literal notranslate"><span class="pre">MultiReference&lt;D&gt;</span></code> class expands on the <code class="docutils literal notranslate"><span class="pre">Wavefunction&lt;D&gt;</span></code>
class by introducing two additional pieces of state: a series of active spaces
and the total number of references. The <code class="docutils literal notranslate"><span class="pre">MultiReference&lt;D&gt;</span></code> class
addresses the <a class="reference internal" href="#wd-initial"><span class="std std-ref">Initial Wavefunction</span></a> consideration.</p>
<p>It is worth noting that, multi-reference wavefunctions are still usually defined
with respect to a single reference determinant. This creates a sort of
ambiguity, which in the future could be expressed by also expressing the
<code class="docutils literal notranslate"><span class="pre">MultiReference&lt;D&gt;</span></code> class in terms of a <code class="docutils literal notranslate"><span class="pre">Transformed&lt;O,</span> <span class="pre">R&gt;</span></code> class. Note,
that true multi-reference wavefunctions do contain (static) correlation and
thus the reuse of the <code class="docutils literal notranslate"><span class="pre">Transformed&lt;O,</span> <span class="pre">R&gt;</span></code> class is thus justified.</p>
</section>
<section id="single-reference-wavefunction-class">
<h4>Single Reference Wavefunction Class<a class="headerlink" href="#single-reference-wavefunction-class" title="Link to this heading"></a></h4>
<p>A common scenario is that the initial wavefunction contains a single reference.
This leads to a number of simplifications. The <code class="docutils literal notranslate"><span class="pre">SingleReference&lt;D&gt;</span></code> class is
a strong type denoting this common scenario.</p>
</section>
<section id="general-active-space-gas-wavefunction">
<h4>General Active Space (GAS) Wavefunction<a class="headerlink" href="#general-active-space-gas-wavefunction" title="Link to this heading"></a></h4>
<p>Just as it’s important to know when the initial state is a single reference, it
is important to know when the wavefunction is guaranteed to have at least one
active space. The <code class="docutils literal notranslate"><span class="pre">GAS&lt;D&gt;</span></code> strong type indicates that the initial wavefunction
has at least one active space.</p>
</section>
<section id="restricted-active-space-ras-wavefunction">
<h4>Restricted Active Space (RAS) Wavefunction<a class="headerlink" href="#restricted-active-space-ras-wavefunction" title="Link to this heading"></a></h4>
<p>A common active space partitioning defines three active spaces. The first
active space has a limit on how many holes it may have, the second has a
restriction on how many particles it may have, and the third is allowed to have
any number of holes and particles, so long as one does not violate the
restrictions on the first two active spaces. This active space choice is
typically known as RAS, and the strong type denoting this scenario is
thus <code class="docutils literal notranslate"><span class="pre">RAS&lt;D&gt;</span></code>.</p>
</section>
<section id="complete-active-space-cas-wavefunction">
<h4>Complete Active Space (CAS) Wavefunction<a class="headerlink" href="#complete-active-space-cas-wavefunction" title="Link to this heading"></a></h4>
<p>Another common active space partitioning is to define a single active space
and consider all possible excitations within that active space. This defines
the CAS method for defining an active space and the corresponding strong type
is denoted <code class="docutils literal notranslate"><span class="pre">CAS&lt;D&gt;</span></code>.</p>
</section>
<section id="example-initial-wavefunctions">
<h4>Example Initial Wavefunctions<a class="headerlink" href="#example-initial-wavefunctions" title="Link to this heading"></a></h4>
<figure class="align-center" id="id2">
<span id="fig-initial-wavefunctions"></span><img alt="../../../_images/reference_wavefunctions.png" src="../../../_images/reference_wavefunctions.png" />
<figcaption>
<p><span class="caption-number">Fig. 20 </span><span class="caption-text">How common initial reference wavefunctions are defined using Chemist’s
wavefunction component.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#fig-initial-wavefunctions"><span class="std std-numref">Fig. 20</span></a> shows types for common reference
wavefunctions fit into Chemist’s wavefunction component.</p>
</section>
</section>
<section id="correlated-wavefunctions">
<h3>Correlated Wavefunctions<a class="headerlink" href="#correlated-wavefunctions" title="Link to this heading"></a></h3>
<p>For our purposes correlated wavefunctions are those which are defined relative
to some reference wavefunction.</p>
<section id="correlated-base-class">
<h4>Correlated Base Class<a class="headerlink" href="#correlated-base-class" title="Link to this heading"></a></h4>
<p>From consideration <a class="reference internal" href="#wd-correlation"><span class="std std-ref">Correlated Wavefunction</span></a> we need a means of distinguishing
when a wavefunction is correlated or not. To that end, we introduce the
<code class="docutils literal notranslate"><span class="pre">Correlated&lt;R&gt;</span></code> class, which is templated on the type of the initial
wavefunction being correlated. Compared to the <code class="docutils literal notranslate"><span class="pre">Wavefunction&lt;D&gt;</span></code> base,
the additional state is the initial wavefunction.</p>
</section>
<section id="transformed-wavefunction">
<h4>Transformed Wavefunction<a class="headerlink" href="#transformed-wavefunction" title="Link to this heading"></a></h4>
<p>Most (all?) correlated wavefunctions are expressed as transformations of the
initial wavefunction. The <code class="docutils literal notranslate"><span class="pre">Transformed&lt;O,</span> <span class="pre">R&gt;</span></code> class extends the
<code class="docutils literal notranslate"><span class="pre">Correlated&lt;R&gt;</span></code> class by additionally storing the operator used to
transform the initial wavefunction. By templating <code class="docutils literal notranslate"><span class="pre">Transformed&lt;O,R&gt;</span></code> on the
operator it should be relatively easy to extend the wavefunction hierarchy
without deriving new wavefunction types, in accordance with the
<a class="reference internal" href="#wd-easily-extended"><span class="std std-ref">Easily Extended.</span></a> consideration.</p>
</section>
<section id="example-correlated-wavefunctions">
<h4>Example Correlated Wavefunctions<a class="headerlink" href="#example-correlated-wavefunctions" title="Link to this heading"></a></h4>
<p>For the purposes of defining example wavefunctions, we assume the operators
shown in <a class="reference internal" href="../operator/operators.html#fig-many-electron-operators"><span class="std std-numref">Fig. 15</span></a> have already been defined.</p>
<figure class="align-center" id="id3">
<span id="fig-correlated-wavefunctions"></span><img alt="../../../_images/correlated_wavefunctions.png" src="../../../_images/correlated_wavefunctions.png" />
<figcaption>
<p><span class="caption-number">Fig. 21 </span><span class="caption-text">Common wavefunction approximations within electronic structure theory and
how they are releated to the classes in Chemist’s wavefunction component.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<p><a class="reference internal" href="#fig-correlated-wavefunctions"><span class="std std-numref">Fig. 21</span></a> shows some of the wavefunctions
commonly occurring in quantum chemistry and how they are related to classes
in Chemist’s wavefunction and operator components.</p>
</section>
</section>
</section>
<section id="wavefunction-design-summary">
<h2>Wavefunction Design Summary<a class="headerlink" href="#wavefunction-design-summary" title="Link to this heading"></a></h2>
<p>To briefly summarize how our current design addresses the considerations raised
in <a class="reference internal" href="#wd-considerations"><span class="std std-ref">Wavefunction Considerations</span></a>:</p>
<dl class="simple">
<dt><a class="reference internal" href="#wd-initial"><span class="std std-ref">Initial Wavefunction</span></a></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">MultipleReference&lt;D&gt;</span></code> and the <code class="docutils literal notranslate"><span class="pre">SingleReference&lt;D&gt;</span></code> classes provide
relatively generic base classes for distinguishing reference wavefunctions
from correlated wavefunctions.</p>
</dd>
<dt><a class="reference internal" href="#wd-correlation"><span class="std std-ref">Correlated Wavefunction</span></a></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">Correlated&lt;R&gt;</span></code> class allows one to easily denote that a wavefunction
is correlated.</p>
</dd>
<dt><a class="reference internal" href="#wd-easily-extended"><span class="std std-ref">Easily Extended.</span></a></dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">Transformed&lt;O,</span> <span class="pre">R&gt;</span></code> class provides a straightforward mechanism for
creating new wavefunctions by applying operators to existing types.
Admittedly the types get nasty, and we have suggested a number of strong
types to simplify the types and to better make contact with existing
terminology widely used in the field.</p>
</dd>
<dt><a class="reference internal" href="#wd-type-dispatch"><span class="std std-ref">Type Dispatch.</span></a></dt><dd><p>The various strong types, and generalizations throughout the class hierarchy
should allow for general algorithms, as well as theory-specific ones.</p>
</dd>
</dl>
</section>
<section id="future-considerations">
<h2>Future Considerations<a class="headerlink" href="#future-considerations" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>As mentioned, the various multiple reference strong types could concievably
be specified as transformed wavefunctions. If one wants to go that route,
then it makes sense for <code class="docutils literal notranslate"><span class="pre">Transformed&lt;O,</span> <span class="pre">R&gt;</span></code> to be a mix-in (replace <code class="docutils literal notranslate"><span class="pre">R</span></code>
with a template type <code class="docutils literal notranslate"><span class="pre">B</span></code>, which is the type of the base class).</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="reference_space.html" class="btn btn-neutral float-left" title="Reference Space Design" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../developing_the_chemical_system_component.html" class="btn btn-neutral float-right" title="Developing the Chemical System Component" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, NWChemEx Community.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>